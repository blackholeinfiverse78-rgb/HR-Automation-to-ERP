# Event & Signal Contracts

This document freezes the data structures for the HR-to-ERP Automation Bridge. 

## 1. HR_EVENT_SHORTLISTED (Domain Event)
**Producer:** Recruitment Dashboard / ATS  
**Consumer:** Automation Bridge (Rule Engine)  

| Field | Type | Description |
| :--- | :--- | :--- |
| `event_id` | UUID | Unique identifier for the audit log. |
| `tenant_id` | String | Mandatory. The corporate entity (Acme, Globex, etc). |
| `idempotency_key` | String | Key generated by the UI to prevent duplicate event ingestion. |
| `entity_id` | String | The Candidate ID (e.g., `cand_123`). |
| `action` | Literal | Fixed: `SHORTLISTED`. |
| `actor_role` | String | Role of the person who took the action. |

---

## 2. HR_ALERT_STUCK (Rule Invariant)
**Producer:** SLA Rule Engine  
**Consumer:** HR Dashboards / Notification Service  

**Violation Logic:** `IF (current_time - last_event.timestamp) > 7 Days AND status == 'INTERVIEW_SCHEDULED'`.

| Field | Type | Description |
| :--- | :--- | :--- |
| `alert_id` | UUID | Unique alert instance ID. |
| `tenant_id` | String | Mandatory. Ensures isolation in the multi-tenant dashboard. |
| `alert_type` | String | Fixed: `SLA_BREACH_STUCK`. |
| `severity` | String | `CRITICAL` (for > 7 days breaches). |
| `reason` | String | Human-readable trace proof of the violation. |
| `metadata` | Object | Evidence payload (e.g., `days_in_stage`). |

---

## 3. ERP_EVENT_EMPLOYEE_CREATED (Integration Signal)
**Producer:** ERP Mapper (Translation Layer)  
**Consumer:** Artha / EMS / Downstream ERP Systems  

**Contract Version:** 2.0  

| Field | Type | Description |
| :--- | :--- | :--- |
| `signal_id` | UUID | Unique ID for the ERP message. |
| `contract_version`| String | `2.0`. Required for Artha compatibility. |
| `tenant_id` | String | Mandatory. Target organization in the ERP. |
| `event_type` | Literal | `EMPLOYEE_CREATED`. |
| `effective_date` | ISO Date | Date the hire becomes official. |
| `audit_trail` | Object | **Back-reference to HR Event.** Contains `original_event_id`. |
| `payload` | Object | Data verified against ERP schema (e.g., `onboarding_status`). |

---

## Reliability Note
Every message MUST contain a `tenant_id`. Messages without a `tenant_id` are rejected at the edge (FastAPI model validation).
